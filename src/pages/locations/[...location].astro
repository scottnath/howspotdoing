---
import { getCollection } from 'astro:content';
import Layout from '@components/Layout.astro';
import Location from '@components/Location.astro';
import { seoConfig } from '@util/seoConfig';
import { getEntry } from 'astro:content';
export async function getStaticPaths() {
  const locations = await getCollection('locations');

  return locations.flatMap((entry) => {
    // Convert hpd-new-york to new-york (remove hpd- prefix)
    const slug = entry.id.replace(/^hpd-/, '');
    return [
      // /locations/[location]
      { params: { location: slug }, props: { entry } },
      // /locations/united-states/[location]
      { params: { location: `united-states/${slug}` }, props: { entry } },
    ];
  });
}

const { location } = Astro.params;
// Extract slug from path (handles both "new-york" and "united-states/new-york")
const slug = location?.includes('/') ? location.split('/').pop() : location;
const content = await getEntry('locations', `hpd-${slug}`);
const title = `${content.data.answer} - ${seoConfig.siteNickname}`;
---

<Layout title={title} bodyClass="location-page" socialCardSlug={slug}>
  <Location location={content} />
</Layout>

